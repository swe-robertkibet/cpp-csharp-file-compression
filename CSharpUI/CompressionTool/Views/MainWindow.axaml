<Window xmlns="https://github.com/avaloniaui" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:vm="using:CompressionTool.ViewModels" xmlns:views="using:CompressionTool.Views" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="700" x:Class="CompressionTool.Views.MainWindow" x:DataType="vm:MainWindowViewModel" Icon="/Assets/avalonia-logo.ico" Title="File Compression Tool" MinWidth="800" MinHeight="600">


  <Grid Background="#F8F9FA" Margin="20">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <!-- Header -->
    <Border Grid.Row="0" Background="#FFFFFF" CornerRadius="12" BoxShadow="0 2 8 0 #20000000" Padding="24" Margin="0,0,0,20">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0" Orientation="Vertical">
          <TextBlock Text="File Compression Tool" FontSize="28" FontWeight="Bold" Foreground="#2C3E50" />
          <TextBlock Text="Compress and decompress files using RLE, Huffman, and LZW algorithms" FontSize="14" Foreground="#7F8C8D" Margin="0,4,0,0" />
        </StackPanel>

        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="12">
          <Border Background="#E3F2FD" CornerRadius="8" Padding="12,8">
            <TextBlock Text="{Binding StatusMessage}" FontWeight="Medium" Foreground="#1976D2" />
          </Border>
        </StackPanel>
      </Grid>
    </Border>

    <!-- Main Content -->
    <Grid Grid.Row="1">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="2*" />
        <ColumnDefinition Width="20" />
        <ColumnDefinition Width="1*" />
      </Grid.ColumnDefinitions>

      <!-- Left Panel - File Operations -->
      <Border Grid.Column="0" Background="#FFFFFF" CornerRadius="12" BoxShadow="0 2 8 0 #20000000" Padding="24">
        <ScrollViewer>
          <StackPanel Spacing="24">

            <!-- Operation Mode -->
            <StackPanel>
              <TextBlock Text="Operation Mode" FontSize="16" FontWeight="SemiBold" Foreground="#2C3E50" Margin="0,0,0,12" />
              <StackPanel Orientation="Horizontal" Spacing="16">
                <RadioButton Content="Compress" IsChecked="{Binding IsCompression}" FontSize="14" Foreground="#34495E" />
                <RadioButton Content="Decompress" IsChecked="{Binding IsDecompression}" FontSize="14" Foreground="#34495E" />
              </StackPanel>
            </StackPanel>

            <!-- Algorithm Selection -->
            <StackPanel>
              <TextBlock Text="Compression Algorithm" FontSize="16" FontWeight="SemiBold" Foreground="#2C3E50" Margin="0,0,0,12" />
              <ComboBox ItemsSource="{Binding AvailableAlgorithms}" SelectedItem="{Binding SelectedAlgorithmOption}" MinWidth="300" FontSize="14">
                <ComboBox.ItemTemplate>
                  <DataTemplate>
                    <StackPanel>
                      <TextBlock Text="{Binding Name}" FontWeight="Medium" />
                      <TextBlock Text="{Binding Description}" FontSize="12" Foreground="#7F8C8D" />
                    </StackPanel>
                  </DataTemplate>
                </ComboBox.ItemTemplate>
              </ComboBox>
            </StackPanel>

            <!-- File Selection -->
            <StackPanel>
              <TextBlock Text="Input File" FontSize="16" FontWeight="SemiBold" Foreground="#2C3E50" Margin="0,0,0,12" />
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBox Grid.Column="0" Text="{Binding InputFilePath}" Watermark="Select input file..." FontSize="14" Padding="12" CornerRadius="6" Margin="0,0,8,0" />
                <Button Grid.Column="1" Content="Browse" Command="{Binding BrowseInputFileCommand}" Background="#3498DB" Foreground="White" Padding="16,8" CornerRadius="6" FontWeight="Medium" />
              </Grid>
            </StackPanel>

            <StackPanel>
              <TextBlock Text="Output File" FontSize="16" FontWeight="SemiBold" Foreground="#2C3E50" Margin="0,0,0,12" />
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBox Grid.Column="0" Text="{Binding OutputFilePath}" Watermark="Output file path..." FontSize="14" Padding="12" CornerRadius="6" Margin="0,0,8,0" />
                <Button Grid.Column="1" Content="Browse" Command="{Binding BrowseOutputFileCommand}" Background="#95A5A6" Foreground="White" Padding="16,8" CornerRadius="6" FontWeight="Medium" />
              </Grid>
            </StackPanel>

            <!-- Execute Button -->
            <Button Content="{Binding IsCompression, Converter={x:Static views:OperationTextConverter.Instance}}" Command="{Binding ExecuteOperationCommand}" IsEnabled="{Binding !IsOperationInProgress}" Background="#27AE60" Foreground="White" FontSize="16" FontWeight="Bold" Padding="24,16" CornerRadius="8" HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" />

            <!-- Progress Indicator -->
            <ProgressBar IsVisible="{Binding IsOperationInProgress}" IsIndeterminate="True" Height="4" Foreground="#3498DB" />

          </StackPanel>
        </ScrollViewer>
      </Border>

      <!-- Right Panel - Results and Log -->
      <StackPanel Grid.Column="2" Spacing="20">

        <!-- Metrics Card -->
        <Border Background="#FFFFFF" CornerRadius="12" BoxShadow="0 2 8 0 #20000000" Padding="20" IsVisible="{Binding LastResult, Converter={x:Static ObjectConverters.IsNotNull}}">
          <StackPanel Spacing="16">
            <TextBlock Text="ðŸ“Š Metrics" FontSize="16" FontWeight="SemiBold" Foreground="#2C3E50" />

            <StackPanel Spacing="12" IsVisible="{Binding LastResult.Success}">
              <!-- File Sizes -->
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="Auto" />
                  <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="Original:" FontSize="12" Foreground="#7F8C8D" Width="80" />
                <TextBlock Grid.Column="1" Text="{Binding LastResult.OriginalSizeFormatted}" FontSize="12" FontWeight="Medium" />
              </Grid>

              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="Auto" />
                  <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="Compressed:" FontSize="12" Foreground="#7F8C8D" Width="80" />
                <TextBlock Grid.Column="1" Text="{Binding LastResult.CompressedSizeFormatted}" FontSize="12" FontWeight="Medium" />
              </Grid>

              <!-- Compression Ratio -->
              <Border Background="#E8F5E8" CornerRadius="6" Padding="8">
                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                  </Grid.ColumnDefinitions>
                  <TextBlock Grid.Column="0" Text="Ratio:" FontSize="12" Foreground="#27AE60" Width="80" />
                  <TextBlock Grid.Column="1" Text="{Binding LastResult.CompressionRatioFormatted}" FontSize="14" FontWeight="Bold" Foreground="#27AE60" />
                </Grid>
              </Border>

              <!-- Timing -->
              <Grid IsVisible="{Binding IsCompression}">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="Auto" />
                  <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="Time:" FontSize="12" Foreground="#7F8C8D" Width="80" />
                <TextBlock Grid.Column="1" Text="{Binding LastResult.CompressionTimeFormatted}" FontSize="12" FontWeight="Medium" />
              </Grid>

              <Grid IsVisible="{Binding IsDecompression}">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="Auto" />
                  <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="Time:" FontSize="12" Foreground="#7F8C8D" Width="80" />
                <TextBlock Grid.Column="1" Text="{Binding LastResult.DecompressionTimeFormatted}" FontSize="12" FontWeight="Medium" />
              </Grid>

              <!-- Speed -->
              <Grid IsVisible="{Binding IsCompression}">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="Auto" />
                  <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="Speed:" FontSize="12" Foreground="#7F8C8D" Width="80" />
                <TextBlock Grid.Column="1" Text="{Binding LastResult.CompressionSpeedFormatted}" FontSize="12" FontWeight="Medium" />
              </Grid>

              <Grid IsVisible="{Binding IsDecompression}">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="Auto" />
                  <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="Speed:" FontSize="12" Foreground="#7F8C8D" Width="80" />
                <TextBlock Grid.Column="1" Text="{Binding LastResult.DecompressionSpeedFormatted}" FontSize="12" FontWeight="Medium" />
              </Grid>
            </StackPanel>

            <!-- Error Message -->
            <Border Background="#FFEBEE" CornerRadius="6" Padding="8" IsVisible="{Binding LastResult.Success, Converter={x:Static BoolConverters.Not}}">
              <TextBlock Text="{Binding LastResult.ErrorMessage}" FontSize="12" Foreground="#C62828" TextWrapping="Wrap" />
            </Border>
          </StackPanel>
        </Border>

        <!-- Activity Log -->
        <Border Background="#FFFFFF" CornerRadius="12" BoxShadow="0 2 8 0 #20000000" Padding="20">
          <StackPanel Spacing="12">
            <Grid>
              <TextBlock Text="ðŸ“‹ Activity Log" FontSize="16" FontWeight="SemiBold" Foreground="#2C3E50" />
              <Button Content="Clear" Command="{Binding ClearLogCommand}" Background="Transparent" Foreground="#E74C3C" FontSize="12" HorizontalAlignment="Right" Padding="8,4" />
            </Grid>

            <ScrollViewer Height="200">
              <ItemsControl ItemsSource="{Binding LogMessages}">
                <ItemsControl.ItemTemplate>
                  <DataTemplate>
                    <TextBlock Text="{Binding}" FontSize="11" Foreground="#34495E" Margin="0,2" TextWrapping="Wrap" />
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>
            </ScrollViewer>
          </StackPanel>
        </Border>

      </StackPanel>
    </Grid>

    <!-- Footer -->
    <Border Grid.Row="2" Background="#34495E" CornerRadius="8" Padding="16" Margin="0,20,0,0">
      <TextBlock Text="Built with C++ compression engine and modern Avalonia UI" FontSize="12" Foreground="#BDC3C7" HorizontalAlignment="Center" />
    </Border>
  </Grid>

</Window>